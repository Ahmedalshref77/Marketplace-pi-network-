import React, { useState } from "react";
import ProductList from "./components/ProductList";
import ProductDetails from "./components/ProductDetails";
import Wallet from "./components/Wallet";
import AddProduct from "./components/AddProduct";


function App() {
  const [page, setPage] = useState("home");
  const [selectedProduct, setSelectedProduct] = useState(null);
  const [walletBalance, setWalletBalance] = useState(500); // رصيد تجريبي
  const [transactions, setTransactions] = useState([]);


  const [products, setProducts] = useState([
    { id: 1, name: "كتاب تعليمي", price: 10, description: "كتاب PDF مفيد", image: "https://via.placeholder.com/150" },
    { id: 2, name: "سماعات", price: 50, description: "سماعات بلوتوث", image: "https://via.placeholder.com/150" },
  ]);


  const handleBuy = (product) => {
    if (walletBalance >= product.price) {
      setWalletBalance(walletBalance - product.price);
      setTransactions([...transactions, `اشتريت ${product.name} بـ ${product.price} π`]);
      alert("تمت عملية الشراء بنجاح ✅");
    } else {
      alert("رصيد غير كافي ❌");
    }
  };


  const handleAddProduct = (newProduct) => {
    setProducts([...products, { id: products.length + 1, ...newProduct }]);
    setPage("home");
  };


  return (
    <div style={{ fontFamily: "Arial", padding: "20px" }}>
      <h1>🛍️ Pi Marketplace</h1>
      <nav style={{ marginBottom: "20px" }}>
        <button onClick={() => setPage("home")}>الرئيسية</button>
        <button onClick={() => setPage("wallet")}>المحفظة</button>
        <button onClick={() => setPage("add")}>إضافة منتج</button>
      </nav>


      {page === "home" && !selectedProduct && (
        <ProductList products={products} onSelect={setSelectedProduct} />
      )}


      {selectedProduct && (
        <ProductDetails
          product={selectedProduct}
          onBack={() => setSelectedProduct(null)}
          onBuy={handleBuy}
        />
      )}


      {page === "wallet" && (
        <Wallet balance={walletBalance} transactions={transactions} />
      )}


      {page === "add" && <AddProduct onAdd={handleAddProduct} />}
    </div>
  );
}


export default App;